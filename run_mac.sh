#!/bin/bash

# –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
VENV_DIR=".venv"

echo "üöÄ –ó–∞–ø—É—Å–∫ GenAI Dashboard..."

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Python
if ! command -v python3 &> /dev/null; then
    echo "‚ùå –û—à–∏–±–∫–∞: Python 3 –Ω–µ –Ω–∞–π–¥–µ–Ω!"
    echo "üëâ –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python: https://www.python.org/downloads/"
    exit 1
fi

# 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
if [ ! -d "$VENV_DIR" ]; then
    echo "üì¶ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –°–æ–∑–¥–∞–µ–º..."
    python3 -m venv $VENV_DIR
    echo "‚úÖ –û–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ."
fi

# 3. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
source $VENV_DIR/bin/activate

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
if [ -f "requirements.txt" ]; then
    echo "‚¨áÔ∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –±–∏–±–ª–∏–æ—Ç–µ–∫..."
    pip install -r requirements.txt -q
else
    echo "‚ö†Ô∏è –§–∞–π–ª requirements.txt –Ω–µ –Ω–∞–π–¥–µ–Ω!"
fi

# 5. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
echo "üü¢ –ó–∞–ø—É—Å–∫–∞–µ–º Streamlit..."
streamlit run app.py